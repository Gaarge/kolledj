<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Расписание колледжа</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { background: #454d5d; font-family: 'Times New Roman', serif;}
    .container { width: 360px; margin: 30px auto; padding: 24px 0; border-radius: 32px; text-align: center;}
    .btn { margin: 10px 8px; font-size: 24px; background: #198d34; color: #fff; padding: 8px 24px; border-radius: 12px; border: none; cursor: pointer;}
    .back-btn { background: #4457a5;}
    .variant-btn { background: #e69724;}
    .schedule { margin: 18px auto; width: 98%; }
    .schedule-table { border-collapse: collapse; margin: 0 auto; }
    .schedule-table th, .schedule-table td { border: 1px solid #fff; padding: 8px 16px; font-size: 20px; background: #837faf; color: #fff;}
    .schedule-list { text-align: left; margin-left: 16px;}
    .schedule-list .day { font-size: 24px; color: #fff; margin-top: 12px;}
    .schedule-list ul { list-style: decimal; margin-left: 18px;}
  </style>
</head>
<body>
<div class="container">
  <input type="file" id="excelFileInput">
  <button class="btn back-btn" onclick="window.location.href='index.html'">Назад в меню</button>
  <button class="btn variant-btn" id="toggleViewBtn">Вид: Таблица</button>
  <div id="scheduleContainer" class="schedule"></div>
</div>
<script>
  const excelFileInput = document.getElementById('excelFileInput');
  const scheduleContainer = document.getElementById('scheduleContainer');
  const toggleViewBtn = document.getElementById('toggleViewBtn');
  let scheduleData = [];
  let tableView = true;

  toggleViewBtn.onclick = function() {
    tableView = !tableView;
    toggleViewBtn.textContent = tableView ? "Вид: Таблица" : "Вид: Список";
    renderSchedule();
  };

  excelFileInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(ev) {
      const data = new Uint8Array(ev.target.result);
      const workbook = XLSX.read(data, {type: 'array'});
      const firstSheetName = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[firstSheetName];
      scheduleData = XLSX.utils.sheet_to_json(worksheet, {header:1});
      renderSchedule();
    };
    reader.readAsArrayBuffer(file);
  });

  function renderSchedule() {
    if (scheduleData.length === 0) {
      scheduleContainer.innerHTML = "<p>Нет расписания для отображения.</p>";
      return;
    }
    if (tableView) {
      let html = '<table class="schedule-table">';
      scheduleData.forEach((row, idx) => {
        html += '<tr>';
        row.forEach(cell => {
          html += (idx === 0)
                  ? `<th>${cell}</th>`
                  : `<td>${cell}</td>`;
        });
        html += '</tr>';
      });
      html += '</table>';
      scheduleContainer.innerHTML = html;
    } else {
      let html = '<div class="schedule-list">';
      scheduleData.forEach((row, idx) => {
        if (idx === 0) return;
        html += `<div class="day">${row[0]}</div><ul>`;
        for (let i = 1; i < row.length; i++) {
          if (row[i]) html += `<li>${row[i]}</li>`;
        }
        html += '</ul>';
      });
      html += '</div>';
      scheduleContainer.innerHTML = html;
    }
  }
</script>
</body>
</html>
